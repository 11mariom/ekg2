/*
 *  (C) Copyright 2006-2008 Jakub Zawadzki <darkjames@darkjames.ath.cx>
 *                     2008 Wies³aw Ochmiñski <wiechu@wiechu.com>
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License Version 2 as
 *  published by the Free Software Foundation.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

#include <string.h>

#include "icq_caps.h"

typedef unsigned char _capability_t[16];
static const _capability_t _caps[CAP_UNKNOWN+1] =
{
	{0x01, 0x38, 0xca, 0x7b, 0x76, 0x9a, 0x49, 0x15, 0x88, 0xf2, 0x13, 0xfc, 0x00, 0x97, 0x9e, 0xa8},	// CAP_HTML
	{0x09, 0x46, 0x00, 0x00, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_NEWCAPS
	{0x09, 0x46, 0x13, 0x41, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_VOICE
	{0x09, 0x46, 0x13, 0x42, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_AIMDIRPLAY
	{0x09, 0x46, 0x13, 0x43, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_SENDFILE
	{0x09, 0x46, 0x13, 0x44, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_ICQDIRECT
	{0x09, 0x46, 0x13, 0x45, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_IMIMAGE
	{0x09, 0x46, 0x13, 0x46, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_BUDDYICON
	{0x09, 0x46, 0x13, 0x47, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_SAVESTOCKS
	{0x09, 0x46, 0x13, 0x48, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_GETFILE
	{0x09, 0x46, 0x13, 0x49, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_SRV_RELAY
	{0x09, 0x46, 0x13, 0x4a, 0x4c, 0x7f, 0x11, 0xd1, 0x22, 0x82, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_GAMES2
	{0x09, 0x46, 0x13, 0x4a, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_GAMES
	{0x09, 0x46, 0x13, 0x4b, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_CONTACTS
	{0x09, 0x46, 0x13, 0x4c, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_DEVILS
	{0x09, 0x46, 0x13, 0x4d, 0x4d, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_INTEROPERATE
	{0x09, 0x46, 0x13, 0x4e, 0x4c, 0x7f, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_UTF
	{0x1a, 0x09, 0x3c, 0x6c, 0xd7, 0xfd, 0x4e, 0xc5, 0x9d, 0x51, 0xa6, 0x47, 0x4e, 0x34, 0xf5, 0xa0},	// CAP_XTRAZ
	{0x56, 0x3f, 0xc8, 0x09, 0x0b, 0x6f, 0x41, 0xbd, 0x9f, 0x79, 0x42, 0x26, 0x09, 0xdf, 0xa2, 0xf3},	// CAP_TYPING
	{0x74, 0x8f, 0x24, 0x20, 0x62, 0x87, 0x11, 0xd1, 0x82, 0x22, 0x44, 0x45, 0x53, 0x54, 0x00, 0x00},	// CAP_CHAT
	{0x97, 0xb1, 0x27, 0x51, 0x24, 0x3c, 0x43, 0x34, 0xad, 0x22, 0xd6, 0xab, 0xf7, 0x3f, 0x14, 0x92},	// CAP_RTF
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}	// CAP_UNKNOWN
};

int icq_cap_id(unsigned char *buf) {
	int i;
	if (buf)
		return CAP_UNKNOWN;
	for (i=0; i<CAP_UNKNOWN; i++) {
		if (memcmp(buf, _caps[i], 0x10))
			return i;
	}
	return CAP_UNKNOWN;
}

const unsigned char *icq_cap_str(int id) {
	if ( (id>0) && (id<CAP_UNKNOWN) )
		return _caps[id];

	return _caps[CAP_UNKNOWN];
}

const char *icq_capability_name(int id) {
	static const char *names[CAP_UNKNOWN] = {
				"HTML",
				"New format of caps",
				"Voice chat",
				"Direct play service",
				"File transfer (can send files)",
				"Something called \"route finder\" (ICQ2K only)",
				"DirectIM/IMImage",
				"Avatar service.",
				"Stocks (add-ins)",
				"Filetransfers (can receive files)",
				"Channel 2 extended, TLV(0x2711) based messages",
				"Games",
				"Games",
				"Buddy lists transfer",
				"Devils",
				"AIM & ICQ messages",
				"UTF-8 messages",
				"XTRAZ",
				"Mini typing notifications",
				"Chat service",
				"RTF messages"
				};

	if ( (id>0) && (id<CAP_UNKNOWN) )
		return names[id];

	return "Unknown";
}

